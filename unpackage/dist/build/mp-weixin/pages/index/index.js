(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"0906":function(e,t,n){"use strict";var a=n("abf5"),o=n.n(a);o.a},2342:function(e,t,n){"use strict";n.r(t);var a=n("c0b4"),o=n("feb4");for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("0906");var c=n("f0c5"),r=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"6ec0e050",null,!1,a["a"],void 0);t["default"]=r.exports},"76ba":function(e,t,n){"use strict";(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("2eee")),i=a(n("c973")),c={data:function(){return{imageUrl:"",tempFilePath:"",imgId:"",isAnalyze:!1}},onLoad:function(){e.getStorage({key:"ctToken",success:function(e){console.log(e)}})},methods:{chooseImage:function(){var t=this;e.chooseImage({count:1,success:function(e){t.tempFilePath=e.tempFilePaths[0],t.imageUrl=e.tempFilePaths[0]},fail:function(e){console.error("选择图片失败",e)}})},uploadImage:function(){var t=this;return(0,i.default)(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.getStorage({key:"ctToken",success:function(n){var a=n.data.token;e.uploadFile({url:"http://81.68.99.212:8080/img/upload",filePath:t.tempFilePath,name:"multipartFile",header:{Authorization:"Bearer "+a,"Content-Type":"multipart/form-data"},formData:{},success:function(n){t.imgId=JSON.parse(n.data).data.id,console.log(e.getStorageSync("ctToken")),t.ctAnalyze(),t.clearImage()},fail:function(e){console.error("上传失败",e)}})},fail:function(e){console.error("获取Token失败",e)}});case 1:case"end":return n.stop()}}),n)})))()},ctAnalyze:function(){e.showLoading({title:"正在分析中，请稍等"});var t=e.getStorageSync("ctToken"),n=t.token,a=t.info.id;e.request({url:"http://81.68.99.212:8080/record/analyse",method:"POST",header:{Authorization:"Bearer "+n,"content-type":"application/json"},data:{userId:a,imgId:this.imgId},success:function(t){console.log(t),e.hideLoading(),e.showToast({title:"分析成功",duration:1500,icon:"success"})},fail:function(e){console.log(e)}})},clearImage:function(){this.imageUrl="",this.tempFilePath=""}}};t.default=c}).call(this,n("543d")["default"])},abf5:function(e,t,n){},c0b4:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement;this._self._c},o=[]},feb4:function(e,t,n){"use strict";n.r(t);var a=n("76ba"),o=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=o.a},ff77:function(e,t,n){"use strict";(function(e,t){var a=n("4ea4");n("6e72");a(n("66fd"));var o=a(n("2342"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])}},[["ff77","common/runtime","common/vendor"]]]);